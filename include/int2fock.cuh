/*
 * GANSU: GPU Accelerated Numerical Simulation Utility
 *
 * Copyright (c) 2025-2026, Hiroshima University and Fujitsu Limited
 * All rights reserved.
 *
 * This software is licensed under the BSD 3-Clause License.
 * You may obtain a copy of the license in the LICENSE file
 * located in the root directory of this source tree or at:
 * https://opensource.org/licenses/BSD-3-Clause
 *
 * SPDX-License-Identifier: BSD-3-Clause
 */

#ifndef INT2FOCK_CUH
#define INT2FOCK_CUH

namespace gansu::gpu{

__device__ inline 
void swap_indices(int& mu, int& nu)
{
    int tmp = mu;
    mu = nu;
    nu = tmp;
}

__device__ inline void add2fock(
    real_t val, real_t* g_fock, int mu, int nu, int la, int si, 
    const int num_basis, const real_t* g_dens, const real_t* g_cgto_normalization_factors) 
{

    if (mu > nu) {
        swap_indices(mu, nu);
    }
    if (la > si) {
        swap_indices(la, si);
    }
    if (mu > la || (mu == la && nu > si)) {
        swap_indices(mu, la);
        swap_indices(nu, si);
    }

    bool is_sym_bra = false;
    bool is_sym_ket = false;
    bool is_sym_braket = false;
    if (mu == nu) is_sym_bra = true;
    if (la == si) is_sym_ket = true;
    if (mu == la && nu == si) is_sym_braket = true;

    val *= 0.5 * g_cgto_normalization_factors[mu] * g_cgto_normalization_factors[nu] * g_cgto_normalization_factors[la] * g_cgto_normalization_factors[si];

    if (is_sym_bra && is_sym_ket && is_sym_braket) {
        atomicAdd(g_fock + num_basis * mu + nu, 1.0 * g_dens[num_basis * la + si] * val);
    }
    else if (is_sym_bra && is_sym_ket) {
        atomicAdd(g_fock + num_basis * mu + nu, 2.0 * g_dens[num_basis * la + si] * val);
        atomicAdd(g_fock + num_basis * la + si, 2.0 * g_dens[num_basis * mu + nu] * val);
        atomicAdd(g_fock + num_basis * mu + la, (-1.0) * g_dens[num_basis * nu + si] * val);
    }
    else if (is_sym_bra) {
        atomicAdd(g_fock + num_basis * mu + nu, 4.0 * g_dens[num_basis * la + si] * val);
        atomicAdd(g_fock + num_basis * la + si, 2.0 * g_dens[num_basis * mu + nu] * val);
        atomicAdd(g_fock + num_basis * mu + la, ((mu == la) ? -2.0 : -1.0) * g_dens[num_basis * nu + si] * val);
        atomicAdd(g_fock + num_basis * nu + si, (-1.0) * g_dens[num_basis * mu + la] * val);
    }
    else if (is_sym_ket) {
        atomicAdd(g_fock + num_basis * mu + nu, 2.0 * g_dens[num_basis * la + si] * val);
        atomicAdd(g_fock + num_basis * la + si, 4.0 * g_dens[num_basis * mu + nu] * val);
        atomicAdd(g_fock + num_basis * mu + la, (-1.0) * g_dens[num_basis * nu + si] * val);
        atomicAdd(g_fock + ((nu <= si) ? num_basis * nu + si : num_basis * si + nu), ((nu == si) ? -2.0 : -1.0) * g_dens[num_basis * mu + la] * val);
    }
    else if (is_sym_braket) {
        atomicAdd(g_fock + num_basis * mu + nu, 4.0 * g_dens[num_basis * la + si] * val);
        atomicAdd(g_fock + num_basis * mu + la, (-1.0) * g_dens[num_basis * nu + si] * val);
        atomicAdd(g_fock + num_basis * nu + si, (-1.0) * g_dens[num_basis * mu + la] * val);
        atomicAdd(g_fock + num_basis * mu + si, (-1.0) * g_dens[num_basis * nu + la] * val);
    }
    else {
        atomicAdd(g_fock + num_basis * mu + nu, 4.0 * g_dens[num_basis * la + si] * val);
        atomicAdd(g_fock + num_basis * la + si, 4.0 * g_dens[num_basis * mu + nu] * val);
        atomicAdd(g_fock + num_basis * mu + la, ((mu == la) ? -2.0 : -1.0) * g_dens[num_basis * nu + si] * val);
        atomicAdd(g_fock + ((nu <= si) ? num_basis * nu + si : num_basis * si + nu), ((nu == si) ? -2.0 : -1.0) * g_dens[num_basis * mu + la] * val);
        atomicAdd(g_fock + num_basis * mu + si, (-1.0) * g_dens[num_basis * nu + la] * val);
        atomicAdd(g_fock + ((nu <= la) ? num_basis * nu + la : num_basis * la + nu), ((nu == la) ? -2.0 : -1.0) * g_dens[num_basis * mu + si] * val);
    }
}


__device__ inline void ssss2fock(
    const PrimitiveShell& a, const PrimitiveShell& b, const PrimitiveShell&  c, const PrimitiveShell&  d, 
    const bool bra, const bool ket, const bool braket, real_t* g_fock, const int num_basis, 
    const real_t* g_boys_grid, const real_t* g_dens, const real_t* g_cgto_normalization_factors)
{
    const real_t Rp[3] = {(a.exponent*a.coordinate.x + b.exponent*b.coordinate.x)/(a.exponent+b.exponent), (a.exponent*a.coordinate.y + b.exponent*b.coordinate.y)/(a.exponent+b.exponent), (a.exponent*a.coordinate.z + b.exponent*b.coordinate.z)/(a.exponent+b.exponent)};
    const real_t Rq[3] = {(c.exponent*c.coordinate.x + d.exponent*d.coordinate.x)/(c.exponent+d.exponent), (c.exponent*c.coordinate.y + d.exponent*d.coordinate.y)/(c.exponent+d.exponent), (c.exponent*c.coordinate.z + d.exponent*d.coordinate.z)/(c.exponent+d.exponent)};

    int magnification = 1;
    if (bra && (a.basis_index == b.basis_index)) {
        magnification *= 2;
    }
    if (ket && (c.basis_index == d.basis_index)) {
        magnification *= 2;
    }
    if (braket && ((a.basis_index == c.basis_index) && (b.basis_index == d.basis_index))) {
        magnification *= 2;
    }

    add2fock(a.coefficient * b.coefficient* c.coefficient * d.coefficient * magnification * calcNorms(a.exponent, b.exponent, c.exponent, d.exponent, 0,0,0, 0,0,0, 0,0,0, 0,0,0) * 2.0*pow(M_PI,2.5)/((a.exponent+b.exponent)*(c.exponent+d.exponent)*pow(a.exponent + b.exponent + c.exponent + d.exponent,0.5)) * exp(-(a.exponent*b.exponent)*((a.coordinate.x-b.coordinate.x)*(a.coordinate.x-b.coordinate.x) + (a.coordinate.y-b.coordinate.y)*(a.coordinate.y-b.coordinate.y) + (a.coordinate.z-b.coordinate.z)*(a.coordinate.z-b.coordinate.z))/(a.exponent+b.exponent) -(c.exponent*d.exponent)*((c.coordinate.x-d.coordinate.x)*(c.coordinate.x-d.coordinate.x) + (c.coordinate.y-d.coordinate.y)*(c.coordinate.y-d.coordinate.y) + (c.coordinate.z-d.coordinate.z)*(c.coordinate.z-d.coordinate.z))/(c.exponent+d.exponent)) * getSingleBoys(0, (a.exponent+b.exponent)*(c.exponent+d.exponent)/(a.exponent+b.exponent+c.exponent+d.exponent)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0])+((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))+(Rp[2]-Rq[2])*(Rp[2]-Rq[2])), g_boys_grid),
             g_fock, a.basis_index, b.basis_index, c.basis_index, d.basis_index, num_basis, g_dens, g_cgto_normalization_factors);
}


__device__ inline void sssp2fock(
    const PrimitiveShell& a, const PrimitiveShell& b, const PrimitiveShell& c, const PrimitiveShell& d, 
    const bool bra, real_t* g_fock, const int num_basis, const real_t* g_boys_grid, const real_t* g_dens, const real_t* g_cgto_normalization_factors)
{
    const real_t p = a.exponent+b.exponent;
    const real_t q = c.exponent+d.exponent;
    const real_t Rp[3] = {(a.exponent*a.coordinate.x + b.exponent*b.coordinate.x)/p, (a.exponent*a.coordinate.y + b.exponent*b.coordinate.y)/p, (a.exponent*a.coordinate.z + b.exponent*b.coordinate.z)/p};
    const real_t Rq[3] = {(c.exponent*c.coordinate.x + d.exponent*d.coordinate.x)/q, (c.exponent*c.coordinate.y + d.exponent*d.coordinate.y)/q, (c.exponent*c.coordinate.z + d.exponent*d.coordinate.z)/q};
    real_t Boys[2];
    getIncrementalBoys(1, p*q/(p+q)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]) + (Rp[1]-Rq[1])*(Rp[1]-Rq[1]) + (Rp[2]-Rq[2])*(Rp[2]-Rq[2])), g_boys_grid, Boys);
    real_t coefAndNorm = a.coefficient * b.coefficient * c.coefficient * d.coefficient * calcNorms(a.exponent, b.exponent, c.exponent, d.exponent, 0,0,0, 0,0,0, 0,0,0, 1,0,0) * 2.0*pow(M_PI,2.5)/(p*q*pow(p+q,0.5)) * exp(-(a.exponent*b.exponent)*((a.coordinate.x-b.coordinate.x)*(a.coordinate.x-b.coordinate.x) + (a.coordinate.y-b.coordinate.y)*(a.coordinate.y-b.coordinate.y) + (a.coordinate.z-b.coordinate.z)*(a.coordinate.z-b.coordinate.z))/p-(c.exponent*d.exponent)*((c.coordinate.x-d.coordinate.x)*(c.coordinate.x-d.coordinate.x) + (c.coordinate.y-d.coordinate.y)*(c.coordinate.y-d.coordinate.y) + (c.coordinate.z-d.coordinate.z)*(c.coordinate.z-d.coordinate.z))/q);
    
    if (bra && (a.basis_index == b.basis_index)) {
        coefAndNorm *= 2;
    }

    //*
    if (true) {
        add2fock(coefAndNorm * (((c.coordinate.x - d.coordinate.x) + (Rq[0] - c.coordinate.x))*Boys[0] + ((Rp[0]-Rq[0])*p/(p + q))*Boys[1]),
                      g_fock, a.basis_index, b.basis_index, c.basis_index, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((c.coordinate.y - d.coordinate.y) + (Rq[1] - c.coordinate.y))*Boys[0] + ((Rp[1]-Rq[1])*p/(p + q))*Boys[1]),
                      g_fock, a.basis_index, b.basis_index, c.basis_index, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((c.coordinate.z - d.coordinate.z) + (Rq[2] - c.coordinate.z))*Boys[0] + ((Rp[2]-Rq[2])*p/(p + q))*Boys[1]),
                      g_fock, a.basis_index, b.basis_index, c.basis_index, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    /**/

}



__device__ inline void sspp2fock(
    const PrimitiveShell& a, const PrimitiveShell& b, const PrimitiveShell& c, const PrimitiveShell& d, 
    const bool bra, const bool ket, real_t* g_fock, const int num_basis, const real_t* g_boys_grid, const real_t* g_dens, const real_t* g_cgto_normalization_factors)
{
    real_t p = a.exponent+b.exponent;
    real_t q = c.exponent+d.exponent;
    real_t Rp[3] = {(a.exponent*a.coordinate.x + b.exponent*b.coordinate.x)/p, (a.exponent*a.coordinate.y + b.exponent*b.coordinate.y)/p, (a.exponent*a.coordinate.z + b.exponent*b.coordinate.z)/p};
    real_t Rq[3] = {(c.exponent*c.coordinate.x + d.exponent*d.coordinate.x)/q, (c.exponent*c.coordinate.y + d.exponent*d.coordinate.y)/q, (c.exponent*c.coordinate.z + d.exponent*d.coordinate.z)/q};
    real_t Boys[3];
    getIncrementalBoys(2, p*q/(p+q)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]) + (Rp[1]-Rq[1])*(Rp[1]-Rq[1]) + (Rp[2]-Rq[2])*(Rp[2]-Rq[2])), g_boys_grid, Boys);
    real_t coefAndNorm = a.coefficient * b.coefficient* c.coefficient * d.coefficient * calcNorms(a.exponent, b.exponent, c.exponent, d.exponent, 0,0,0, 0,0,0, 1,0,0, 1,0,0) * 2.0*pow(M_PI,2.5)/(p*q*pow(p+q,0.5)) * exp(-(a.exponent*b.exponent)*((a.coordinate.x-b.coordinate.x)*(a.coordinate.x-b.coordinate.x) + (a.coordinate.y-b.coordinate.y)*(a.coordinate.y-b.coordinate.y) + (a.coordinate.z-b.coordinate.z)*(a.coordinate.z-b.coordinate.z))/p-(c.exponent*d.exponent)*((c.coordinate.x-d.coordinate.x)*(c.coordinate.x-d.coordinate.x) + (c.coordinate.y-d.coordinate.y)*(c.coordinate.y-d.coordinate.y) + (c.coordinate.z-d.coordinate.z)*(c.coordinate.z-d.coordinate.z))/q);
    
    if (bra && (a.basis_index == b.basis_index)) {
        coefAndNorm *= 2;
    }
    if (ket && (c.basis_index == d.basis_index)) {
        coefAndNorm *= 2;
    }


    //*
    if (true) {
        add2fock(coefAndNorm * (((c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x) + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x)) + 0.5/q) * Boys[0] + (p*((c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q - 0.5)/(q*(p + q))) * Boys[1] + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(p*p)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[0] - c.coordinate.x)*((c.coordinate.y - d.coordinate.y) + (Rq[1] - c.coordinate.y))) * Boys[0] + (p*((Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y) + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y) + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1]))/(p + q)) * Boys[1] + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(p*p)/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[0] - c.coordinate.x)*((c.coordinate.z - d.coordinate.z) + (Rq[2] - c.coordinate.z))) * Boys[0] + (p*((Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z) + (Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z) + (Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2]))/(p + q)) * Boys[1] + ((Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(p*p)/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y) + ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y)) + 0.5/q) * Boys[0] + (p*((c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - 0.5)/(q*(p + q))) * Boys[1] + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[1] - c.coordinate.y)*((c.coordinate.z - d.coordinate.z) + (Rq[2] - c.coordinate.z))) * Boys[0] + (p*((Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z) + (Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2]))/(p + q)) * Boys[1] + ((Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z) + ((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5/q) * Boys[0] + (p*((c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 0.5)/(q*(p + q))) * Boys[1] + (((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }

    if (c.basis_index != d.basis_index) {
        if (true) {
            add2fock(coefAndNorm * (((Rq[1] - c.coordinate.y)*((c.coordinate.x - d.coordinate.x) + (Rq[0] - c.coordinate.x))) * Boys[0] + (p*((c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1]) + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y) + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1]))/(p + q)) * Boys[1] + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(p*p)/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                          g_fock, a.basis_index, b.basis_index, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
        }
        if (true) {
            add2fock(coefAndNorm * (((Rq[2] - c.coordinate.z)*((c.coordinate.x - d.coordinate.x) + (Rq[0] - c.coordinate.x))) * Boys[0] + (p*((c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2]) + (Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z) + (Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2]))/(p + q)) * Boys[1] + ((Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(p*p)/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                          g_fock, a.basis_index, b.basis_index, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
        }
        if (true) {
            add2fock(coefAndNorm * (((Rq[2] - c.coordinate.z)*((c.coordinate.y - d.coordinate.y) + (Rq[1] - c.coordinate.y))) * Boys[0] + (p*((c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2]) + (Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2]))/(p + q)) * Boys[1] + ((Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                          g_fock, a.basis_index, b.basis_index, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
        }
    }

    /**/


}


//*
__device__ inline void spsp2fock(
    const PrimitiveShell& a, const PrimitiveShell& b, const PrimitiveShell& c, const PrimitiveShell& d, 
    const bool braket, real_t* g_fock, const int num_basis, const real_t* g_boys_grid, const real_t* g_dens, const real_t* g_cgto_normalization_factors)
{
    real_t p = a.exponent+b.exponent;
    real_t q = c.exponent+d.exponent;
    real_t Rp[3] = {(a.exponent*a.coordinate.x + b.exponent*b.coordinate.x)/p, (a.exponent*a.coordinate.y + b.exponent*b.coordinate.y)/p, (a.exponent*a.coordinate.z + b.exponent*b.coordinate.z)/p};
    real_t Rq[3] = {(c.exponent*c.coordinate.x + d.exponent*d.coordinate.x)/q, (c.exponent*c.coordinate.y + d.exponent*d.coordinate.y)/q, (c.exponent*c.coordinate.z + d.exponent*d.coordinate.z)/q};
    real_t Boys[3];
    getIncrementalBoys(2, p*q/(p+q)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]) + (Rp[1]-Rq[1])*(Rp[1]-Rq[1]) + (Rp[2]-Rq[2])*(Rp[2]-Rq[2])), g_boys_grid, Boys);
    real_t coefAndNorm = a.coefficient * b.coefficient* c.coefficient * d.coefficient
                * calcNorms(a.exponent, b.exponent, c.exponent, d.exponent, 0,0,0, 1,0,0, 0,0,0, 1,0,0)
                * 2.0*pow(M_PI,2.5)/(p*q*pow(p+q,0.5))
                * exp(-(a.exponent*b.exponent)*((a.coordinate.x-b.coordinate.x)*(a.coordinate.x-b.coordinate.x) + (a.coordinate.y-b.coordinate.y)*(a.coordinate.y-b.coordinate.y) + (a.coordinate.z-b.coordinate.z)*(a.coordinate.z-b.coordinate.z))/p
                        -(c.exponent*d.exponent)*((c.coordinate.x-d.coordinate.x)*(c.coordinate.x-d.coordinate.x) + (c.coordinate.y-d.coordinate.y)*(c.coordinate.y-d.coordinate.y) + (c.coordinate.z-d.coordinate.z)*(c.coordinate.z-d.coordinate.z))/q);
    
    if (braket && ((a.basis_index == c.basis_index) && (b.basis_index == d.basis_index))) {
        coefAndNorm *= 2;
    }


    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x) + (a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x) + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x) + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)) * Boys[0] + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q + 1.0)/(p + q)) * Boys[1] + (-((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*p*q/((p*p) + 2.0*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index+0, c.basis_index, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y) + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)) * Boys[0] + (((a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*p + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*q - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q)/(p + q)) * Boys[1] + (-(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p*q/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index+0, c.basis_index, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z) + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z)) * Boys[0] + (((a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*p + (Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - (Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*q - (Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1] + (-(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p*q/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index+0, c.basis_index, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y) + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y) + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)) * Boys[0] + (0.5*(2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 1.0)/(p + q)) * Boys[1] + (-((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q/((p*p) + 2.0*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index+1, c.basis_index, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z) + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)) * Boys[0] + (((a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + (Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - (Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q - (Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1] + (-(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index+1, c.basis_index, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z) + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)) * Boys[0] + (0.5*(2.0*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 1.0)/(p + q)) * Boys[1] + (-((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q/((p*p) + 2.0*p*q + (q*q))) * Boys[2]),
                      g_fock, a.basis_index, b.basis_index+2, c.basis_index, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }

    if (a.basis_index != c.basis_index || b.basis_index != d.basis_index) {
        if (true) {
            add2fock(coefAndNorm * (((c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y) + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)) * Boys[0] + ((-(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*q + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*p + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q)/(p + q)) * Boys[1] + (-(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p*q/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                          g_fock, a.basis_index, b.basis_index+1, c.basis_index, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
        }
        if (true) {
            add2fock(coefAndNorm * (((c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z) + (Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)) * Boys[0] + ((-(c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*q + (Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p - (Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/(p + q)) * Boys[1] + (-(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p*q/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                          g_fock, a.basis_index, b.basis_index+2, c.basis_index, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
        }
        if (true) {
            add2fock(coefAndNorm * (((c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z) + (Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)) * Boys[0] + ((-(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + (Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + (Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - (Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(p + q)) * Boys[1] + (-(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q/((p*p) + 2*p*q + (q*q))) * Boys[2]),
                          g_fock, a.basis_index, b.basis_index+2, c.basis_index, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
        }
    }


}
/**/



__device__ inline void sppp2fock(
    const PrimitiveShell& a, const PrimitiveShell& b, const PrimitiveShell& c, const PrimitiveShell& d, 
    const bool ket, real_t* g_fock, const int num_basis, const real_t* g_boys_grid, const real_t* g_dens, const real_t* g_cgto_normalization_factors)
{
    real_t p = a.exponent+b.exponent;
    real_t q = c.exponent+d.exponent;
    real_t Rp[3] = {(a.exponent*a.coordinate.x + b.exponent*b.coordinate.x)/p, (a.exponent*a.coordinate.y + b.exponent*b.coordinate.y)/p, (a.exponent*a.coordinate.z + b.exponent*b.coordinate.z)/p};
    real_t Rq[3] = {(c.exponent*c.coordinate.x + d.exponent*d.coordinate.x)/q, (c.exponent*c.coordinate.y + d.exponent*d.coordinate.y)/q, (c.exponent*c.coordinate.z + d.exponent*d.coordinate.z)/q};
    real_t Boys[4];
    getIncrementalBoys(3, p*q/(p+q)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]) + (Rp[1]-Rq[1])*(Rp[1]-Rq[1]) + (Rp[2]-Rq[2])*(Rp[2]-Rq[2])), g_boys_grid, Boys);
    real_t coefAndNorm = a.coefficient * b.coefficient* c.coefficient * d.coefficient
                * calcNorms(a.exponent, b.exponent, c.exponent, d.exponent, 0,0,0, 1,0,0, 1,0,0, 1,0,0)
                * 2.0*pow(M_PI,2.5)/(p*q*pow(p+q,0.5))
                * exp(-(a.exponent*b.exponent)*((a.coordinate.x-b.coordinate.x)*(a.coordinate.x-b.coordinate.x) + (a.coordinate.y-b.coordinate.y)*(a.coordinate.y-b.coordinate.y) + (a.coordinate.z-b.coordinate.z)*(a.coordinate.z-b.coordinate.z))/p
                        -(c.exponent*d.exponent)*((c.coordinate.x-d.coordinate.x)*(c.coordinate.x-d.coordinate.x) + (c.coordinate.y-d.coordinate.y)*(c.coordinate.y-d.coordinate.y) + (c.coordinate.z-d.coordinate.z)*(c.coordinate.z-d.coordinate.z))/q);
    
    if (ket && (c.basis_index == d.basis_index)) {
        coefAndNorm *= 2;
    }


    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x) + (a.coordinate.x - b.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x)) + 0.5*(a.coordinate.x - b.coordinate.x)/q + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x) + (Rp[0] - a.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x)) + 0.5*(Rp[0] - a.coordinate.x)/q) * Boys[0] + (0.25*(4.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*p*q + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*p + 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p*q - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(q*q) + 2.0*(c.coordinate.x - d.coordinate.x)*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*p*q - 2.0*(Rp[0] - a.coordinate.x)*p - 4.0*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(q*q) - 2.0*(Rp[0]-Rq[0])*q + 4.0*(Rq[0] - c.coordinate.x)*q)/(q*(p + q))) * Boys[1] + ((Rp[0]-Rq[0])*p*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p - 4.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q + 3.0)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-((Rp[0]-Rq[0])*(Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+0, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);   
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[0] - c.coordinate.x)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y) + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y))) * Boys[0] + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*q + (c.coordinate.y - d.coordinate.y) + (Rq[1] - c.coordinate.y))/(p + q)) * Boys[1] + (p*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q + (Rp[1]-Rq[1]))/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+0, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);   
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[0] - c.coordinate.x)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z) + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z))) * Boys[0] + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*q + (c.coordinate.z - d.coordinate.z) + (Rq[2] - c.coordinate.z))/(p + q)) * Boys[1] + (p*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.z - d.coordinate.z)*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q + (Rp[2]-Rq[2]))/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+0, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y) + (a.coordinate.x - b.coordinate.x)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y)) + 0.5*(a.coordinate.x - b.coordinate.x)/q + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y) + (Rp[0] - a.coordinate.x)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y)) + 0.5*(Rp[0] - a.coordinate.x)/q) * Boys[0] + (((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q - 0.5*(a.coordinate.x - b.coordinate.x)*p + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q - 0.5*(Rp[0] - a.coordinate.x)*p - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(q*q) - (Rp[0]-Rq[0])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) - 0.5*(Rp[0]-Rq[0])*q)/(q*(p + q))) * Boys[1] + (p*((a.coordinate.x - b.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p + (Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 0.5*(Rp[0]-Rq[0]))/((p*p) + 2.0*p*q + (q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+0, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[1] - c.coordinate.y)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z) + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z))) * Boys[0] + (((a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p + (a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + (a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1] + (p*((a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/((p*p) + 2*p*q + (q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3*(p*p)*q + 3*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+0, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z) + (a.coordinate.x - b.coordinate.x)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*(a.coordinate.x - b.coordinate.x)/q + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z) + (Rp[0] - a.coordinate.x)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*(Rp[0] - a.coordinate.x)/q) * Boys[0] + (((a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 0.5*(a.coordinate.x - b.coordinate.x)*p + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 0.5*(Rp[0] - a.coordinate.x)*p - (Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 0.5*(Rp[0]-Rq[0])*q)/(q*(p + q))) * Boys[1] + (p*((a.coordinate.x - b.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + (Rp[0] - a.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - (Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 0.5*(Rp[0]-Rq[0]))/((p*p) + 2.0*p*q + (q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+0, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y) + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.y - b.coordinate.y) + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1] - a.coordinate.y) + 0.5*(a.coordinate.y - b.coordinate.y)/q + 0.5*(Rp[1] - a.coordinate.y)/q) * Boys[0] + (((c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*p*q + (c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p*q - (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(q*q) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*p*q - ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1]-Rq[1])*(q*q) - 0.5*(a.coordinate.y - b.coordinate.y)*p - 0.5*(Rp[1] - a.coordinate.y)*p - 0.5*(Rp[1]-Rq[1])*q)/(q*(p + q))) * Boys[1] + (p*(-(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*q + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*p + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*p - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q + 0.5*(Rp[1]-Rq[1]))/((p*p) + 2.0*p*q + (q*q))) * Boys[2] + (-((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+1, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[0] - c.coordinate.x)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y) + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y) + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y))) * Boys[0] + (0.5*(2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*p + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (Rq[0] - c.coordinate.x))/(p + q)) * Boys[1] + (p*(2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (Rp[0]-Rq[0]) - 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+1, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[0] - c.coordinate.x)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z) + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z))) * Boys[0] + (((Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1] + (p*((Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q)/((p*p) + 2*p*q + (q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3*(p*p)*q + 3*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+1, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y) + (a.coordinate.y - b.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y)) + 0.5*(a.coordinate.y - b.coordinate.y)/q + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y) + (Rp[1] - a.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y)) + 0.5*(Rp[1] - a.coordinate.y)/q) * Boys[0] + (0.25*(4.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q + 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q - 2.0*(a.coordinate.y - b.coordinate.y)*p + 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q - 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) + 2.0*(c.coordinate.y - d.coordinate.y)*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q - 2.0*(Rp[1] - a.coordinate.y)*p - 4.0*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) - 2.0*(Rp[1]-Rq[1])*q + 4.0*(Rq[1] - c.coordinate.y)*q)/(q*(p + q))) * Boys[1] + ((Rp[1]-Rq[1])*p*(2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 4.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 3.0)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-((Rp[1]-Rq[1])*(Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+1, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[1] - c.coordinate.y)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z) + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z))) * Boys[0] + (0.5*(2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p + 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (c.coordinate.z - d.coordinate.z) + (Rq[2] - c.coordinate.z))/(p + q)) * Boys[1] + (p*(2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*q - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + (Rp[2]-Rq[2]))/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+1, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z) + (a.coordinate.y - b.coordinate.y)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*(a.coordinate.y - b.coordinate.y)/q + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z) + (Rp[1] - a.coordinate.y)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*(Rp[1] - a.coordinate.y)/q) * Boys[0] + (((a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 0.5*(a.coordinate.y - b.coordinate.y)*p + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 0.5*(Rp[1] - a.coordinate.y)*p - (Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[1]-Rq[1])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 0.5*(Rp[1]-Rq[1])*q)/(q*(p + q))) * Boys[1] + (p*((a.coordinate.y - b.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + (Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - (Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 0.5*(Rp[1]-Rq[1]))/((p*p) + 2.0*p*q + (q*q))) * Boys[2] + (-(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+1, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z) + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.z - b.coordinate.z) + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2] - a.coordinate.z) + 0.5*(a.coordinate.z - b.coordinate.z)/q + 0.5*(Rp[2] - a.coordinate.z)/q) * Boys[0] + (((c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*p*q + (c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p*q - (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(q*q) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*p*q - ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2]-Rq[2])*(q*q) - 0.5*(a.coordinate.z - b.coordinate.z)*p - 0.5*(Rp[2] - a.coordinate.z)*p - 0.5*(Rp[2]-Rq[2])*q)/(q*(p + q))) * Boys[1] + (p*(-(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*q + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.z - b.coordinate.z)*p + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q + 0.5*(Rp[2]-Rq[2]))/((p*p) + 2.0*p*q + (q*q))) * Boys[2] + (-((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+2, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[0] - c.coordinate.x)*((c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z) + (Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z))) * Boys[0] + (((Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*p + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p - (Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - (Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(p + q)) * Boys[1] + (p*(-(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q)/((p*p) + 2*p*q + (q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3*(p*p)*q + 3*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+2, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[0] - c.coordinate.x)*((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z) + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))) * Boys[0] + (0.5*(2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rq[0] - c.coordinate.x))/(p + q)) * Boys[1] + (p*(2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0]-Rq[0]) - 2.0*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+2, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z) + ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(a.coordinate.z - b.coordinate.z) + ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2] - a.coordinate.z) + 0.5*(a.coordinate.z - b.coordinate.z)/q + 0.5*(Rp[2] - a.coordinate.z)/q) * Boys[0] + (((c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p*q + (c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q - (c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2]-Rq[2])*(q*q) - 0.5*(a.coordinate.z - b.coordinate.z)*p - 0.5*(Rp[2] - a.coordinate.z)*p - 0.5*(Rp[2]-Rq[2])*q)/(q*(p + q))) * Boys[1] + (p*(-(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q + ((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*p + ((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + 0.5*(Rp[2]-Rq[2]))/((p*p) + 2.0*p*q + (q*q))) * Boys[2] + (-((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+2, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((Rq[1] - c.coordinate.y)*((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z) + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))) * Boys[0] + (0.5*(2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rq[1] - c.coordinate.y))/(p + q)) * Boys[1] + (p*(2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[1]-Rq[1]) - 2.0*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+2, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }
    if (true) {
        add2fock(coefAndNorm * (((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z) + (a.coordinate.z - b.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*(a.coordinate.z - b.coordinate.z)/q + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z) + (Rp[2] - a.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*(Rp[2] - a.coordinate.z)/q) * Boys[0] + (0.25*(4.0*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 8.0*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(a.coordinate.z - b.coordinate.z)*p + 4.0*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 4.0*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) + 2.0*(c.coordinate.z - d.coordinate.z)*q + 8.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[2] - a.coordinate.z)*p - 4.0*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 2.0*(Rp[2]-Rq[2])*q + 4.0*(Rq[2] - c.coordinate.z)*q)/(q*(p + q))) * Boys[1] + ((Rp[2]-Rq[2])*p*(2.0*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 4.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 3.0)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-((Rp[2]-Rq[2])*(Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
            g_fock, a.basis_index, b.basis_index+2, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors);
    }


    if (c.basis_index != d.basis_index) {
        if (true) {
            add2fock(coefAndNorm * (((Rq[1] - c.coordinate.y)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x) + (a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x) + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x) + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x))) * Boys[0] + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*q + (Rq[1] - c.coordinate.y))/(p + q)) * Boys[1] + (p*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q + (Rp[1]-Rq[1]))/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
                g_fock, a.basis_index, b.basis_index+0, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
        }   
        if (true) {
            add2fock(coefAndNorm * (((Rq[2] - c.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x) + (a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x) + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x) + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x))) * Boys[0] + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*q + (Rq[2] - c.coordinate.z))/(p + q)) * Boys[1] + (p*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q + (Rp[2]-Rq[2]))/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
                g_fock, a.basis_index, b.basis_index+0, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
        }
        if (true) {
            add2fock(coefAndNorm * (((Rq[2] - c.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y) + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y))) * Boys[0] + (((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p + (a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + (a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rq[2] - c.coordinate.z)*q - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1] + (p*((a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/((p*p) + 2*p*q + (q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3*(p*p)*q + 3*p*(q*q) + (q*q*q))) * Boys[3]),
                g_fock, a.basis_index, b.basis_index+0, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
        }
        if (true) {
            add2fock(coefAndNorm * (((Rq[1] - c.coordinate.y)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y) + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y))) * Boys[0] + (0.5*(2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (c.coordinate.x - d.coordinate.x) + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (Rq[0] - c.coordinate.x))/(p + q)) * Boys[1] + (p*(-2.0*(c.coordinate.x - d.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (Rp[0]-Rq[0]) - 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
                g_fock, a.basis_index, b.basis_index+1, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
        }
        if (true) {
            add2fock(coefAndNorm * (((Rq[2] - c.coordinate.z)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y) + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y))) * Boys[0] + (((c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + (c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - (c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1] + (p*(-(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q)/((p*p) + 2*p*q + (q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3*(p*p)*q + 3*p*(q*q) + (q*q*q))) * Boys[3]),
                g_fock, a.basis_index, b.basis_index+1, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
        }
        if (true) {
            add2fock(coefAndNorm * (((Rq[2] - c.coordinate.z)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y) + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y) + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y))) * Boys[0] + (0.5*(2.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (Rq[2] - c.coordinate.z))/(p + q)) * Boys[1] + (p*(2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + (Rp[2]-Rq[2]))/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
                g_fock, a.basis_index, b.basis_index+1, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
        }
        if (true) {
            add2fock(coefAndNorm * (((Rq[1] - c.coordinate.y)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z) + (Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z))) * Boys[0] + (((c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + (c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - (c.coordinate.x - d.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - (Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(p + q)) * Boys[1] + (p*(-(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q)/((p*p) + 2*p*q + (q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*q/((p*p*p) + 3*(p*p)*q + 3*p*(q*q) + (q*q*q))) * Boys[3]),
                g_fock, a.basis_index, b.basis_index+2, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
        }
        if (true) {
            add2fock(coefAndNorm * (((Rq[2] - c.coordinate.z)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z) + (Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z))) * Boys[0] + (0.5*(2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (c.coordinate.x - d.coordinate.x) + 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rq[0] - c.coordinate.x))/(p + q)) * Boys[1] + (p*(-2.0*(c.coordinate.x - d.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q + 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0]-Rq[0]) - 2.0*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
                g_fock, a.basis_index, b.basis_index+2, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors);
        }
        if (true) {
            add2fock(coefAndNorm * (((Rq[2] - c.coordinate.z)*((c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z) + (Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z))) * Boys[0] + (0.5*(2.0*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (c.coordinate.y - d.coordinate.y) + 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rq[1] - c.coordinate.y))/(p + q)) * Boys[1] + (p*(-2.0*(c.coordinate.y - d.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q + 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[1]-Rq[1]) - 2.0*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2] + (-(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*q/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]),
                g_fock, a.basis_index, b.basis_index+2, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors);
        }
    }

}





__device__ inline int utm_id(const int mu, const int nu)
{
    return (mu <= nu) ? nu * (nu + 1) / 2 + mu : mu * (mu + 1) / 2 + nu;
}

__device__ inline int twoDim2oneDim(const int mu, const int nu, const int num_basis)
{
    return (mu < nu) ? num_basis * mu + nu : num_basis * nu + mu;
}

__device__ inline void add2fock_pppp(
    real_t val, real_t* g_fock, int mu, int nu, int la, int si, 
    const int num_basis, const real_t* g_dens, const real_t* g_cgto_normalization_factors, const bool nosym_braket) 
{
    if (nosym_braket && (twoDim2oneDim(mu, nu, num_basis) != twoDim2oneDim(la, si, num_basis))) {
        val *= 0.5;
    }

    if (mu > nu) {
        swap_indices(mu, nu);
    }
    if (la > si) {
        swap_indices(la, si);
    }
    if (mu > la || (mu == la && nu > si)) {
        swap_indices(mu, la);
        swap_indices(nu, si);
    }

    bool is_sym_bra = false;
    bool is_sym_ket = false;
    bool is_sym_braket = false;
    if (mu == nu) {
        is_sym_bra = true;
    }
    if (la == si) {
        is_sym_ket = true;
    }
    if (mu == la && nu == si) {
        is_sym_braket = true;
    }

    val *= 0.5 * g_cgto_normalization_factors[mu] * g_cgto_normalization_factors[nu] * g_cgto_normalization_factors[la] * g_cgto_normalization_factors[si];

    if (is_sym_bra && is_sym_ket && is_sym_braket) {
        atomicAdd(g_fock + num_basis * mu + nu, 1 * g_dens[num_basis * la + si] * val);
    }
    else if (is_sym_bra && is_sym_ket) {
        atomicAdd(g_fock + num_basis * mu + nu, 2 * g_dens[num_basis * la + si] * val);
        atomicAdd(g_fock + num_basis * la + si, 2 * g_dens[num_basis * mu + nu] * val);
        atomicAdd(g_fock + num_basis * mu + la, (-1) * g_dens[num_basis * nu + si] * val);
    }
    else if (is_sym_bra) {
        atomicAdd(g_fock + num_basis * mu + nu, 4 * g_dens[num_basis * la + si] * val);
        atomicAdd(g_fock + num_basis * la + si, 2 * g_dens[num_basis * mu + nu] * val);
        atomicAdd(g_fock + num_basis * mu + la, ((mu == la) ? -2 : -1) * g_dens[num_basis * nu + si] * val);
        atomicAdd(g_fock + num_basis * nu + si, (-1) * g_dens[num_basis * mu + la] * val);
    }
    else if (is_sym_ket) {
        atomicAdd(g_fock + num_basis * mu + nu, 2 * g_dens[num_basis * la + si] * val);
        atomicAdd(g_fock + num_basis * la + si, 4 * g_dens[num_basis * mu + nu] * val);
        atomicAdd(g_fock + num_basis * mu + la, (-1) * g_dens[num_basis * nu + si] * val);
        atomicAdd(g_fock + ((nu <= si) ? num_basis * nu + si : num_basis * si + nu), ((nu == si) ? -2 : -1) * g_dens[num_basis * mu + la] * val);
    }
    else if (is_sym_braket) {
        atomicAdd(g_fock + num_basis * mu + nu, 4 * g_dens[num_basis * la + si] * val);
        atomicAdd(g_fock + num_basis * mu + la, (-1) * g_dens[num_basis * nu + si] * val);
        atomicAdd(g_fock + num_basis * nu + si, (-1) * g_dens[num_basis * mu + la] * val);
        atomicAdd(g_fock + num_basis * mu + si, (-1) * g_dens[num_basis * nu + la] * val);
    }
    else {
        atomicAdd(g_fock + num_basis * mu + nu, 4 * g_dens[num_basis * la + si] * val);
        atomicAdd(g_fock + num_basis * la + si, 4 * g_dens[num_basis * mu + nu] * val);
        atomicAdd(g_fock + num_basis * mu + la, ((mu == la) ? -2 : -1) * g_dens[num_basis * nu + si] * val);
        atomicAdd(g_fock + ((nu <= si) ? num_basis * nu + si : num_basis * si + nu), ((nu == si) ? -2 : -1) * g_dens[num_basis * mu + la] * val);
        atomicAdd(g_fock + num_basis * mu + si, (-1) * g_dens[num_basis * nu + la] * val);
        atomicAdd(g_fock + ((nu <= la) ? num_basis * nu + la : num_basis * la + nu), ((nu == la) ? -2 : -1) * g_dens[num_basis * mu + si] * val);
    }
}


__device__ inline void pppp2fock(
    const PrimitiveShell& a, const PrimitiveShell& b, const PrimitiveShell& c, const PrimitiveShell& d, 
    const bool bra, const bool ket, const bool braket, real_t* g_fock, const int num_basis, const real_t* g_boys_grid, const real_t* g_dens, const real_t* g_cgto_normalization_factors)
{
    real_t p = a.exponent+b.exponent;
    real_t q = c.exponent+d.exponent;
    real_t Rp[3] = {(a.exponent*a.coordinate.x + b.exponent*b.coordinate.x)/p, (a.exponent*a.coordinate.y + b.exponent*b.coordinate.y)/p, (a.exponent*a.coordinate.z + b.exponent*b.coordinate.z)/p};
    real_t Rq[3] = {(c.exponent*c.coordinate.x + d.exponent*d.coordinate.x)/q, (c.exponent*c.coordinate.y + d.exponent*d.coordinate.y)/q, (c.exponent*c.coordinate.z + d.exponent*d.coordinate.z)/q};
    real_t Boys[5];
    getIncrementalBoys(4, p*q/(p+q)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]) + (Rp[1]-Rq[1])*(Rp[1]-Rq[1]) + (Rp[2]-Rq[2])*(Rp[2]-Rq[2])), g_boys_grid, Boys);
    real_t coefAndNorm = a.coefficient * b.coefficient* c.coefficient * d.coefficient
                * calcNorms(a.exponent, b.exponent, c.exponent, d.exponent, 0,0,1, 0,0,1, 0,0,1, 0,0,1)
                * 2.0*pow(M_PI,2.5)/(p*q*pow(p+q,0.5))
                * exp(-(a.exponent*b.exponent)*((a.coordinate.x-b.coordinate.x)*(a.coordinate.x-b.coordinate.x) + (a.coordinate.y-b.coordinate.y)*(a.coordinate.y-b.coordinate.y) + (a.coordinate.z-b.coordinate.z)*(a.coordinate.z-b.coordinate.z))/p
                        -(c.exponent*d.exponent)*((c.coordinate.x-d.coordinate.x)*(c.coordinate.x-d.coordinate.x) + (c.coordinate.y-d.coordinate.y)*(c.coordinate.y-d.coordinate.y) + (c.coordinate.z-d.coordinate.z)*(c.coordinate.z-d.coordinate.z))/q);
    
    if (bra && (a.basis_index == b.basis_index)) {
        coefAndNorm *= 2;
    }
    if (ket && (c.basis_index == d.basis_index)) {
        coefAndNorm *= 2;
    }
    if (braket && ((a.basis_index == c.basis_index) && (b.basis_index == d.basis_index))) {
        coefAndNorm *= 2;
    }

    bool nosym_braket = utm_id(a.basis_index, b.basis_index) == utm_id(c.basis_index, d.basis_index);

    if (true) {
        add2fock_pppp(coefAndNorm * (((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x) + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x)) + 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)/q + (c.coordinate.x - d.coordinate.x)*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[0] - c.coordinate.x) + 0.5*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)/p + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x)) + 0.5*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))/q + 0.5*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))/p + 0.25/(p*q)) * Boys[0]
            + (0.03125*(32.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(p*p)*q - 32.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*p*(q*q) + 16.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*p*q + 64.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(p*p)*q - 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(p*p) - 32.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*p*(q*q) - 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p*q + 32.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*p*q + 32.0*(c.coordinate.x - d.coordinate.x)*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(p*p)*q - 64.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*p*(q*q) + 32.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*p*q + 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*p*q - 16.0*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(q*q) + 64.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(p*p)*q - 16.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(p*p) - 64.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*p*(q*q) - 32.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p*q + 64.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*p*q + 32.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*p*q - 16.0*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(q*q) - 8.0*p - 8.0*q)/(p*q*(p + q))) * Boys[1]
            + ((-16.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*p*q + 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(p*p) - 32.0*(a.coordinate.x - b.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*p*q + 24.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p - 32.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*p*q + 16.0*(c.coordinate.x - d.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(q*q) - 24.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*q + 16.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(p*p) - 64.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*p*q + 48.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p + 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(q*q) + 8.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*p + 8.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*q - 48.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q + 12.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*q - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p + 4.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q - 6.0)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0])*(Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+0, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*p + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*p + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(c.coordinate.y - d.coordinate.y)*p + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[1] - c.coordinate.y)*p + 0.5*(c.coordinate.y - d.coordinate.y) + 0.5*(Rq[1] - c.coordinate.y))/p) * Boys[0]
            + (0.125*(8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(p*p) + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(p*p) + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(p*p) - 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*p*q - 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*p*q + 4.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*p + 4.0*(a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*p + 8.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(p*p) + 8.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(p*p) + 8.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*p*q - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*p + 8.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*p + 4.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*p + 4.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p - 4.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*q + 4.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p - 4.0*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*q)/(p*(p + q))) * Boys[1]
            + ((2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p*q + (a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*p + 2.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*p*q - 4.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*p*q - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(q*q) + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(q*q) - 3.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*q + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - 3.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[0]-Rq[0])*p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*q + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q - 3.0*(Rp[1]-Rq[1]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+0, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*p + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z)*p + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(c.coordinate.z - d.coordinate.z)*p + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[2] - c.coordinate.z)*p + 0.5*(c.coordinate.z - d.coordinate.z) + 0.5*(Rq[2] - c.coordinate.z))/p) * Boys[0]
            + (0.125*(8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(p*p) + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*(p*p) + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(p*p) - 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*p*q - 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*p*q + 4.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z)*p + 4.0*(a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z)*p + 8.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(p*p) + 8.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*(p*p) + 8.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*p*q - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*p + 8.0*(Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z)*p + 4.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*p + 4.0*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p - 4.0*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*q + 4.0*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p - 4.0*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
            + ((2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[2] - c.coordinate.z)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p*q + (a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.z - d.coordinate.z)*p*q - 4.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[2] - c.coordinate.z)*p*q - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(q*q) + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*(q*q) - 3.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*q + (Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - 3.0*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q - (Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[0]-Rq[0])*p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.z - d.coordinate.z)*q + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q - 3.0*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+0, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y) + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y)) + 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)/q + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y) + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y)) + 0.5*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))/q + 0.5*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)/p + 0.5*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))/p + 0.25/(p*q)) * Boys[0]
            + (((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(p*p)*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(p*p)*q - 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(p*p) - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*p*(q*q) - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*p*(q*q) - 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p*q + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(p*p)*q + 2.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(p*p)*q - 0.5*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*p*(q*q) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*p*(q*q) - (Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p*q + 0.5*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q - 0.5*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(q*q) + (Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q - 0.5*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) - 0.25*p - 0.25*q)/(p*q*(p + q))) * Boys[1]
            + (((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p) - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + (Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(q*q) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) + 0.5*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*q - 0.5*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 0.5*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p - (Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 0.25)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*(-(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - 0.5*((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) - 0.5*((Rp[1]-Rq[1])*(Rp[1]-Rq[1])))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+0, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rq[1] - c.coordinate.y)*((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*p + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z)*p + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(c.coordinate.z - d.coordinate.z)*p + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[2] - c.coordinate.z)*p + 0.5*(c.coordinate.z - d.coordinate.z) + 0.5*(Rq[2] - c.coordinate.z))/p) * Boys[0]
            + (((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(p*p) + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(p*p) + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p*q - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(p*p) + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(p*p) + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q + 0.5*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p + 0.5*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p - 0.5*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q + 0.5*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 0.5*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
            + (((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(q*q) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*(q*q) - 0.5*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q + 0.5*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 0.5*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - 0.5*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*(-(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 0.5*(Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+0, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z) + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)/q + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z) + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))/q + 0.5*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)/p + 0.5*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))/p + 0.25/(p*q)) * Boys[0]
            + (((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(p*p)*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(p*p)*q - 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(p*p) - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*p*(q*q) - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*p*(q*q) - 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p*q + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(p*p)*q + 2.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(p*p)*q - 0.5*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*p*(q*q) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*p*(q*q) - (Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p*q + 0.5*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) + (Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 0.5*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 0.25*p - 0.25*q)/(p*q*(p + q))) * Boys[1]
            + (((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) + 0.5*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*q - 0.5*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 0.5*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - (Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 0.25)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*(-(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 0.5*((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) - 0.5*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+0, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*((c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*q + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.y - b.coordinate.y)*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1] - a.coordinate.y)*q + 0.5*(a.coordinate.y - b.coordinate.y) + 0.5*(Rp[1] - a.coordinate.y))/q) * Boys[0]
            + (0.25*(4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*p*q + 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p*q - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(q*q) - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(q*q) - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(q*q) + 2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*p*q - 4.0*(Rp[0] - a.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1]-Rq[1])*(q*q) - 2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*q - 4.0*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.y - b.coordinate.y)*(q*q) - 4.0*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1] - a.coordinate.y)*(q*q) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*q + 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*q + 4.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*q)/(q*(p + q))) * Boys[1]
            + ((-2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*q + 2.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(p*p) + 2.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p*q + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - 4.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*p*q - 4.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*p*q + 2.0*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1]-Rq[1])*(q*q) + 3.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*p + 3.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[0]-Rq[0])*p*q*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*p + 4.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q - 3.0*(Rp[1]-Rq[1]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+1, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y) + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y) + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y))) * Boys[0]
            + (0.5*(2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y) + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y) + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y))/(p + q)) * Boys[1]
            + ((16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q + 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p*q - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(q*q) - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) - 8.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q + 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 8.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 8.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
            + (p*q*(-2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q - ((Rp[1]-Rq[1])*(Rp[1]-Rq[1])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+1, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z) + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z))) * Boys[0]
            + (0.5*(2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z) + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
            + ((2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(p*p) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(q*q) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(q*q) + (a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + (Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - (Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q - (Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + (p*q*(-2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - (Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+1, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (a.coordinate.y - b.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*q + 0.5*(a.coordinate.y - b.coordinate.y) + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (Rp[1] - a.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*q + 0.5*(Rp[1] - a.coordinate.y))/q) * Boys[0]
            + (0.25*(4.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q + 8.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*p + 4.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q - 4.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) + 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*p - 4.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*q + 4.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*q - 4.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(q*q) - 4.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*q - 4.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(q*q) - 4.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*q)/(q*(p + q))) * Boys[1]
            + ((2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*p*q + 3.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q - 4.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*p - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*q - 4.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[1]-Rq[1])*p*q*(-2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + 4.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - 3.0*(Rp[0]-Rq[0]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+1, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z) + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z))) * Boys[0]
            + (0.5*(2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
            + ((2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + (Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(q*q) + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*q - (Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + (p*q*(-2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+1, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.y - b.coordinate.y)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(a.coordinate.y - b.coordinate.y) + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (Rp[1] - a.coordinate.y)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(Rp[1] - a.coordinate.y))/q) * Boys[0]
            + (((Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 0.5*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*p + (Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 0.5*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*p - (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 0.5*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*q - (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 0.5*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*q - (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 0.5*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*q)/(q*(p + q))) * Boys[1]
            + (((Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) + (Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 0.5*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 0.5*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*p - (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 0.5*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) + 0.5*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*q)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*(-(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 0.5*(Rp[0]-Rq[0])*(Rp[1]-Rq[1]))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+1, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*((c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*q + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.z - b.coordinate.z)*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2] - a.coordinate.z)*q + 0.5*(a.coordinate.z - b.coordinate.z) + 0.5*(Rp[2] - a.coordinate.z))/q) * Boys[0]
            + (0.25*(4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*p*q + 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p*q - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(q*q) - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(q*q) - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(q*q) + 2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z)*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z)*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*p*q - 4.0*(Rp[0] - a.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.z - b.coordinate.z)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*q - 4.0*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.z - b.coordinate.z)*(q*q) - 4.0*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2] - a.coordinate.z)*(q*q) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*q + 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*q + 4.0*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
            + ((-2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.z - b.coordinate.z)*(p*p) + 2.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p*q + (Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - 4.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*p*q - 4.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2]-Rq[2])*(q*q) + 3.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*p + 3.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[2]-Rq[2])*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[0]-Rq[0])*p*q*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.z - b.coordinate.z)*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*p + 4.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q - 3.0*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+2, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z) + (Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z))) * Boys[0]
            + (0.5*(2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + (c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z) + (Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z))/(p + q)) * Boys[1]
            + ((-2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(p*p) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + (Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + (Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - (Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + (p*q*(-2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - (Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+2, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z) + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))) * Boys[0]
            + (0.5*(2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z) + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
            + ((16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(q*q) - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q + 8.0*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 8.0*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 8.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 8.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
            + (p*q*(-2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - ((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+2, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*((c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*q + (c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(a.coordinate.z - b.coordinate.z)*q + ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2] - a.coordinate.z)*q + 0.5*(a.coordinate.z - b.coordinate.z) + 0.5*(Rp[2] - a.coordinate.z))/q) * Boys[0]
            + (((Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p*q + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q - (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - (Rp[0] - a.coordinate.x)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2]-Rq[2])*(q*q) - 0.5*(Rp[0] - a.coordinate.x)*(a.coordinate.z - b.coordinate.z)*p - 0.5*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*p - 0.5*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(a.coordinate.z - b.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2] - a.coordinate.z)*(q*q) - 0.5*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*q - 0.5*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
            + ((-(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + (Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*(p*p) + (Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + 0.5*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p*q - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + (Rp[0]-Rq[0])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2]-Rq[2])*(q*q) + 0.5*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*p + 0.5*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p + 0.5*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*q)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*(-(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*p + (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*p - (Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 0.5*(Rp[0]-Rq[0])*(Rp[2]-Rq[2]))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+2, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z) + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))) * Boys[0]
            + (0.5*(2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y) - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
            + ((2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + (p*q*(-2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1]) + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+2, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.z - b.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(a.coordinate.z - b.coordinate.z) + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (Rp[2] - a.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(Rp[2] - a.coordinate.z))/q) * Boys[0]
            + (0.25*(4.0*(Rp[0] - a.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 8.0*(Rp[0] - a.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.z - b.coordinate.z)*p + 4.0*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 4.0*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) + 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*p - 4.0*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*q + 4.0*(Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z)*q - 4.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - 4.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*q - 4.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - 4.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
            + ((2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.z - b.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*p*q + 3.0*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 4.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*p - 2.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*q - 4.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) + (Rp[0]-Rq[0])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[2]-Rq[2])*p*q*(-2.0*(Rp[0] - a.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 4.0*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 3.0*(Rp[0]-Rq[0]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+0, b.basis_index+2, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y) + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y)) + 0.5*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)/p + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y) + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y)) + 0.5*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))/p + 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)/q + 0.5*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))/q + 0.25/(p*q)) * Boys[0]
            + (((c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(p*p)*q + (c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(p*p)*q + 0.5*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*p*q - (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p*(q*q) - 2.0*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*(q*q) - 0.5*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(q*q) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(p*p)*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(p*p)*q + (Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*p*q - ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p*(q*q) - 2.0*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*(q*q) - 0.5*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(q*q) - 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(p*p) - 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p*q - 0.5*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(p*p) - (Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q - 0.25*p - 0.25*q)/(p*q*(p + q))) * Boys[1]
            + ((-(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q - 0.5*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*q + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(q*q) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(p*p) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(p*p) + 0.5*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*p - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p*q - 4.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q - (Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(q*q) + 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + (Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + 0.5*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q + 0.25)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*((c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 0.5*((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q - 0.5*((Rp[1]-Rq[1])*(Rp[1]-Rq[1])))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+1, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*p + (a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p + (c.coordinate.y - d.coordinate.y)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*p + 0.5*(c.coordinate.y - d.coordinate.y) + ((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rq[1] - c.coordinate.y)*p + 0.5*(Rq[1] - c.coordinate.y))/p) * Boys[0]
            + (0.25*(4.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(p*p) + 4.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(p*p) + 4.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(p*p) + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*p + 4.0*(Rp[0]-Rq[0])*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rq[1] - c.coordinate.y)*(p*p) + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p - 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q + 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*p - 8.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q - 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*q + 4.0*(Rq[0] - c.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(p*p) - 8.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 4.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*q)/(p*(p + q))) * Boys[1]
            + ((-2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*p - 4.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*q + 2.0*(Rp[0]-Rq[0])*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(p*p) - 4.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q + 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(q*q) - 4.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q + 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*(q*q) - 3.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[1]-Rq[1])*p*q*(-2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q - 4.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - 3.0*(Rp[0]-Rq[0]) + 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+1, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*((a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p + (a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + ((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(c.coordinate.z - d.coordinate.z)*p + ((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rq[2] - c.coordinate.z)*p + 0.5*(c.coordinate.z - d.coordinate.z) + 0.5*(Rq[2] - c.coordinate.z))/p) * Boys[0]
            + (((Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(p*p) + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*(p*p) + (Rp[0]-Rq[0])*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(c.coordinate.z - d.coordinate.z)*(p*p) + (Rp[0]-Rq[0])*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rq[2] - c.coordinate.z)*(p*p) + 0.5*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*p + 0.5*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q + (Rq[0] - c.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 0.5*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*q + 0.5*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p - 0.5*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
            + (((Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 0.5*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*q + 0.5*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - 0.5*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q - (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + (Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*(q*q) + (Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*(q*q) - 0.5*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*(-(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + (Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*q + (Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*q - 0.5*(Rp[0]-Rq[0])*(Rp[2]-Rq[2]) + (Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*q)/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+1, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y) + (a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y)) + 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)/q + (c.coordinate.y - d.coordinate.y)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rq[1] - c.coordinate.y) + 0.5*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)/p + ((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y)) + 0.5*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))/q + 0.5*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))/p + 0.25/(p*q)) * Boys[0]
            + (0.03125*(32.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p)*q - 32.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*(q*q) + 16.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*p*q + 64.0*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(p*p)*q - 16.0*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(p*p) - 32.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*p*(q*q) - 16.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p*q + 32.0*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*p*q + 32.0*(c.coordinate.y - d.coordinate.y)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(p*p)*q - 64.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*(q*q) + 32.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*p*q + 16.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q - 16.0*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(q*q) + 64.0*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(p*p)*q - 16.0*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(p*p) - 64.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*p*(q*q) - 32.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q + 64.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p*q + 32.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q - 16.0*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) - 8.0*p - 8.0*q)/(p*q*(p + q))) * Boys[1]
            + ((-16.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q + 16.0*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p) - 32.0*(a.coordinate.y - b.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*p*q + 24.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 32.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q + 16.0*(c.coordinate.y - d.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*(q*q) - 24.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 16.0*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p) - 64.0*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*p*q + 48.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + 16.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) + 8.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p + 8.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q - 48.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 12.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
            + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q*(-2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q - 4.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + 4.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - 6.0)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1])*(Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+1, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rq[1] - c.coordinate.y)*((a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p + (a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + ((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(c.coordinate.z - d.coordinate.z)*p + ((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rq[2] - c.coordinate.z)*p + 0.5*(c.coordinate.z - d.coordinate.z) + 0.5*(Rq[2] - c.coordinate.z))/p) * Boys[0]
            + (0.125*(8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(p*p) + 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(p*p) + 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p*q - 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q + 4.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p + 4.0*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 8.0*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(p*p) + 8.0*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(p*p) + 8.0*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p*q - 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p + 8.0*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 4.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p + 4.0*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p - 4.0*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q + 4.0*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 4.0*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
            + ((2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 2.0*(a.coordinate.y - b.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(a.coordinate.y - b.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*p*q - 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + (a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*p*q - 4.0*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*p*q - 4.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(q*q) + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*(q*q) - 3.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q + (Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 3.0*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - (Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[1]-Rq[1])*p*q*(-2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 4.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*q + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 3.0*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+1, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z) + (a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)/q + ((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z) + ((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))/q + 0.5*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)/p + 0.5*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))/p + 0.25/(p*q)) * Boys[0]
            + (((a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(p*p)*q + 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(p*p)*q - 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(p*p) - (a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*p*(q*q) - (a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*p*(q*q) - 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p*q + ((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(p*p)*q + 2.0*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(p*p)*q - 0.5*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(p*p) - 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*p*(q*q) - 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*p*(q*q) - (Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q + 0.5*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) + (Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 0.5*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 0.25*p - 0.25*q)/(p*q*(p + q))) * Boys[1]
            + (((a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - (a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + ((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 4.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + ((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) + ((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) + 0.5*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q - 0.5*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 0.5*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - (Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 0.25)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*(-(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + ((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 0.5*((Rp[1]-Rq[1])*(Rp[1]-Rq[1])) - 0.5*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+1, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*((c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*q + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.z - b.coordinate.z)*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2] - a.coordinate.z)*q + 0.5*(a.coordinate.z - b.coordinate.z) + 0.5*(Rp[2] - a.coordinate.z))/q) * Boys[0]
            + (((c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q + (c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(q*q) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(q*q) - ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(q*q) - 0.5*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p - 0.5*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 0.5*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*q - 0.5*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*q - 0.5*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
            + ((-(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q - (c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p*q - (c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(q*q) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(p*p) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(q*q) + 0.5*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p + 0.5*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + 0.5*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + 0.5*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*((c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 0.5*(Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+2, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*((c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z) + (Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z))) * Boys[0]
            + (0.5*(2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*q - 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + (Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z))/(p + q)) * Boys[1]
            + ((-2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(p*p) + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + (Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + (p*q*(2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*p - 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(Rp[2]-Rq[2]) + 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+2, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z) + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))) * Boys[0]
            + (0.5*(2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y) - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
            + ((2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + (p*q*(-2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1]) + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+2, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*((c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*q + (c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(a.coordinate.z - b.coordinate.z)*q + ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2] - a.coordinate.z)*q + 0.5*(a.coordinate.z - b.coordinate.z) + 0.5*(Rp[2] - a.coordinate.z))/q) * Boys[0]
            + (0.25*(4.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p*q + 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q - 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(q*q) - 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(q*q) + 2.0*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*q + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - 4.0*(Rp[1] - a.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p - 2.0*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*q - 4.0*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(a.coordinate.z - b.coordinate.z)*(q*q) - 4.0*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2] - a.coordinate.z)*(q*q) - 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*q - 2.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*q + 4.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*q + 4.0*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
            + ((-2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.y - d.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(c.coordinate.y - d.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p*q + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*(p*p) + 2.0*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(p*p) - 4.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + (Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 4.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q - 4.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2]-Rq[2])*(q*q) + 3.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + 3.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + (Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[1]-Rq[1])*p*q*(2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*p - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p + 4.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 3.0*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+2, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z) + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))) * Boys[0]
            + (0.5*(2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y) - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*q - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z) + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
            + ((16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 16.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*p*q - 16.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 16.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p*q - 16.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(q*q) - 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 8.0*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 8.0*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 8.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 8.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
            + (p*q*(-2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - ((Rp[1]-Rq[1])*(Rp[1]-Rq[1])) + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - ((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+2, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.z - b.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(a.coordinate.z - b.coordinate.z) + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (Rp[2] - a.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(Rp[2] - a.coordinate.z))/q) * Boys[0]
            + (0.25*(4.0*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 8.0*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + 4.0*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 4.0*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) + 2.0*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 4.0*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 2.0*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*q + 4.0*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*q - 4.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - 4.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*q - 4.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - 4.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 2.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
            + ((2.0*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 2.0*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 4.0*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*p*q + 3.0*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 4.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p - 2.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q - 4.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) + (Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[2]-Rq[2])*p*q*(-2.0*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 4.0*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 3.0*(Rp[1]-Rq[1]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + ((Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+1, b.basis_index+2, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z) + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z)) + 0.5*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)/p + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z) + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z)) + 0.5*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))/p + 0.5*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)/q + 0.5*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))/q + 0.25/(p*q)) * Boys[0]
            + (((c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p)*q + (c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p)*q + 0.5*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*p*q - (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*(q*q) - 2.0*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*(q*q) - 0.5*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(q*q) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p)*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p)*q + (Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*p*q - ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*(q*q) - 2.0*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*(q*q) - 0.5*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(q*q) - 0.5*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) - 0.5*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) - (Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.25*p - 0.25*q)/(p*q*(p + q))) * Boys[1]
            + ((-(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*q + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(q*q) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 0.5*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*p - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 4.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - (Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(q*q) + 0.5*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + (Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 0.5*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q + 0.25)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*((c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 0.5*((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 0.5*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+2, b.basis_index+2, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*((c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*p + (c.coordinate.y - d.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*p + 0.5*(c.coordinate.y - d.coordinate.y) + (Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*p + (Rq[1] - c.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*p + 0.5*(Rq[1] - c.coordinate.y))/p) * Boys[0]
            + (((Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 0.5*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*p + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 0.5*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p - (Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*q + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 0.5*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p - (Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*q)/(p*(p + q))) * Boys[1]
            + ((-(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*q + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 0.5*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q + (Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(q*q) - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q + (Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(q*q))/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*((Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 0.5*(Rp[0]-Rq[0])*(Rp[1]-Rq[1]) + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+2, b.basis_index+2, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + (a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + (c.coordinate.z - d.coordinate.z)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*p + 0.5*(c.coordinate.z - d.coordinate.z) + ((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rq[2] - c.coordinate.z)*p + 0.5*(Rq[2] - c.coordinate.z))/p) * Boys[0]
            + (0.25*(4.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + 4.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*(p*p) + 4.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 2.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*p + 4.0*(Rp[0]-Rq[0])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rq[2] - c.coordinate.z)*(p*p) + 2.0*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p - 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*p - 8.0*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*q + 4.0*(Rq[0] - c.coordinate.x)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(p*p) - 8.0*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 4.0*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
            + ((-2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*p - 4.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - (Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - (Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(q*q) - 4.0*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*(q*q) - 3.0*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[2]-Rq[2])*p*q*(-2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 4.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 3.0*(Rp[0]-Rq[0]) + 2.0*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + ((Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+2, b.basis_index+2, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z) + (c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z)) + 0.5*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)/p + ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z) + ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z)) + 0.5*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))/p + 0.5*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)/q + 0.5*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))/q + 0.25/(p*q)) * Boys[0]
            + (((c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p)*q + (c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p)*q + 0.5*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q - (c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*(q*q) - 2.0*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*(q*q) - 0.5*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(q*q) + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p)*q + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p)*q + (Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q - ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*(q*q) - 2.0*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*(q*q) - 0.5*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) - 0.5*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) - 0.5*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) - (Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.25*p - 0.25*q)/(p*q*(p + q))) * Boys[1]
            + ((-(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + (c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(q*q) + ((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + ((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 0.5*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 4.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - (Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + ((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(q*q) + 0.5*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + (Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 0.5*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q + 0.25)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
            + (p*q*((c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - ((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 0.5*((Rp[1]-Rq[1])*(Rp[1]-Rq[1])) + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 0.5*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
            + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+2, b.basis_index+2, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((Rq[1] - c.coordinate.y)*((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + (a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + (c.coordinate.z - d.coordinate.z)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*p + 0.5*(c.coordinate.z - d.coordinate.z) + ((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rq[2] - c.coordinate.z)*p + 0.5*(Rq[2] - c.coordinate.z))/p) * Boys[0]
            + (0.25*(4.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + 4.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*(p*p) + 4.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 2.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p + 4.0*(Rp[1]-Rq[1])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rq[2] - c.coordinate.z)*(p*p) + 2.0*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p - 4.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 4.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 2.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p - 8.0*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q + 4.0*(Rq[1] - c.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(p*p) - 8.0*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 4.0*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
            + ((-2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p - 4.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - (Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q + 2.0*(Rp[1]-Rq[1])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 2.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + (Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - (Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - 2.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(q*q) - 4.0*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*(q*q) - 3.0*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
            + ((Rp[2]-Rq[2])*p*q*(-2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 4.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 3.0*(Rp[1]-Rq[1]) + 2.0*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + ((Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+2, b.basis_index+2, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }
    if (true) {
        add2fock_pppp(coefAndNorm * (((a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z) + (a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)/q + (c.coordinate.z - d.coordinate.z)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rq[2] - c.coordinate.z) + 0.5*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)/p + ((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z)) + 0.5*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))/q + 0.5*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))/p + 0.25/(p*q)) * Boys[0]
            + (0.03125*(32.0*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p)*q - 32.0*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*(q*q) + 16.0*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*p*q + 64.0*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(p*p)*q - 16.0*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) - 32.0*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*p*(q*q) - 16.0*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q + 32.0*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q + 32.0*(c.coordinate.z - d.coordinate.z)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(p*p)*q - 64.0*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*(q*q) + 32.0*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p*q + 16.0*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 16.0*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) + 64.0*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(p*p)*q - 16.0*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) - 64.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*p*(q*q) - 32.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 64.0*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q + 32.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 16.0*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 8.0*p - 8.0*q)/(p*q*(p + q))) * Boys[1]
            + ((-16.0*(a.coordinate.z - b.coordinate.z)*(c.coordinate.z - d.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 16.0*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 32.0*(a.coordinate.z - b.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*p*q + 24.0*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 32.0*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 16.0*(c.coordinate.z - d.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*(q*q) - 24.0*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 16.0*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 64.0*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*p*q + 48.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 16.0*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) + 8.0*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + 8.0*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 48.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 12.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
            + (((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q*(-2.0*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 4.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 4.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 6.0)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
            + (((Rp[2]-Rq[2])*(Rp[2]-Rq[2])*(Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
            g_fock, a.basis_index+2, b.basis_index+2, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
        );
    }




    if (a.basis_index != b.basis_index) {
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*q + (a.coordinate.x - b.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*q + 0.5*(a.coordinate.x - b.coordinate.x) + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*q + (Rp[0] - a.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*q + 0.5*(Rp[0] - a.coordinate.x))/q) * Boys[0]
                + (0.25*(4.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p*q - 4.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(q*q) + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*p*q - 4.0*(a.coordinate.x - b.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1]-Rq[1])*(q*q) - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*q + 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p*q - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(q*q) - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(q*q) + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*p*q - 4.0*(Rp[0] - a.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1]-Rq[1])*(q*q) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*q - 4.0*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1] - a.coordinate.y)*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*q + 4.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*q)/(q*(p + q))) * Boys[1]
                + ((-2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(p*p) - 4.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p*q + (a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*q + 2.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p*q + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - 4.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*p*q + 2.0*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1]-Rq[1])*(q*q) + 3.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[0]-Rq[0])*p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*p + 4.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q - 3.0*(Rp[1]-Rq[1]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+0, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y) + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y))) * Boys[0]
                + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y) + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y))/(p + q)) * Boys[1]
                + ((-16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q + 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*p*q + 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(q*q) - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) - 8.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q - 8.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 8.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
                + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q - ((Rp[1]-Rq[1])*(Rp[1]-Rq[1])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+0, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z) + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
                + ((2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(q*q) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(q*q) + (Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - (Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q - (Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - (Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+0, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (a.coordinate.x - b.coordinate.x)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*q + 0.5*(a.coordinate.x - b.coordinate.x) + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (Rp[0] - a.coordinate.x)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*q + 0.5*(Rp[0] - a.coordinate.x))/q) * Boys[0]
                + (0.0625*(16.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q - 16.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) + 8.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*q + 32.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q - 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*p - 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) - 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*q + 16.0*(a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*q + 16.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q - 16.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) + 8.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*q + 32.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q - 8.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*p - 16.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) - 8.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*q + 16.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*q - 16.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(q*q) - 16.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) - 8.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*q)/(q*(p + q))) * Boys[1]
                + ((-2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p) - 4.0*(a.coordinate.x - b.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*p*q + 3.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*p*q + 3.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*q - 4.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(q*q) + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[1]-Rq[1])*p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p - 2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + 4.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - 3.0*(Rp[0]-Rq[0]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+0, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z) + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
                + ((2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + (a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + (Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(q*q) + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*q - (Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+0, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.x - b.coordinate.x)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(a.coordinate.x - b.coordinate.x) + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(Rp[0] - a.coordinate.x))/q) * Boys[0]
                + (((a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*p - (a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - (a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*q + (Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 0.5*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*p - (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 0.5*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*q - (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 0.5*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*q)/(q*(p + q))) * Boys[1]
                + (((a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - (a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*p + (Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 0.5*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 0.5*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) + 0.5*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*q)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
                + (p*q*(-(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 0.5*(Rp[0]-Rq[0])*(Rp[1]-Rq[1]))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+0, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[2] - a.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*q + (a.coordinate.x - b.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*q + 0.5*(a.coordinate.x - b.coordinate.x) + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*q + (Rp[0] - a.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*q + 0.5*(Rp[0] - a.coordinate.x))/q) * Boys[0]
                + (0.25*(4.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p*q - 4.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(q*q) + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*p*q - 4.0*(a.coordinate.x - b.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2]-Rq[2])*(q*q) - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[2] - a.coordinate.z)*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*q + 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p*q - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(q*q) - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(q*q) + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z)*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*p*q - 4.0*(Rp[0] - a.coordinate.x)*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*q - 4.0*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2] - a.coordinate.z)*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*q + 4.0*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
                + ((-2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(p*p) - 4.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p*q + (a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p*q + (Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - 4.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[2]-Rq[2])*(q*q) + 3.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[2]-Rq[2])*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[0]-Rq[0])*p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*p + 4.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q - 3.0*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+0, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y) + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y))) * Boys[0]
                + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + (c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z))/(p + q)) * Boys[1]
                + ((-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + (Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - (Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - (Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+0, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z) + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
                + ((-16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(q*q) - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q - 8.0*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 8.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 8.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
                + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - ((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+0, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[2] - a.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (a.coordinate.x - b.coordinate.x)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*q + 0.5*(a.coordinate.x - b.coordinate.x) + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (Rp[0] - a.coordinate.x)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*q + 0.5*(Rp[0] - a.coordinate.x))/q) * Boys[0]
                + (((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q - (a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - (a.coordinate.x - b.coordinate.x)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2]-Rq[2])*(q*q) - 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[2] - a.coordinate.z)*p - 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*q + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q - (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - (Rp[0] - a.coordinate.x)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2]-Rq[2])*(q*q) - 0.5*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*p - 0.5*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2] - a.coordinate.z)*(q*q) - 0.5*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
                + ((-(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + (a.coordinate.x - b.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + 0.5*(a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*p - (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + (Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + 0.5*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + (Rp[0]-Rq[0])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2]-Rq[2])*(q*q) + 0.5*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p + 0.5*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*q)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
                + (p*q*(-(a.coordinate.x - b.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*p - (Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*p + (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 0.5*(Rp[0]-Rq[0])*(Rp[2]-Rq[2]))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+0, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z) + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z) + (Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y) - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
                + ((-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1]) + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+0, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[2] - a.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.x - b.coordinate.x)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(a.coordinate.x - b.coordinate.x) + (Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(Rp[0] - a.coordinate.x))/q) * Boys[0]
                + (0.0625*(16.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 16.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) + 8.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z)*q + 32.0*(a.coordinate.x - b.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[2] - a.coordinate.z)*p - 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*q + 16.0*(a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z)*q + 16.0*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 16.0*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) + 8.0*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*q + 32.0*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 8.0*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*p - 16.0*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 8.0*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*q + 16.0*(Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z)*q - 16.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - 16.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 8.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
                + ((-2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.z - d.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 4.0*(a.coordinate.x - b.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*p*q + 3.0*(a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.z - d.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*p*q + 3.0*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*q - 4.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) + (Rp[0]-Rq[0])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[2]-Rq[2])*p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0] - a.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 4.0*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 3.0*(Rp[0]-Rq[0]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+0, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[2] - a.coordinate.z)*((c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*q + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.y - b.coordinate.y)*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1] - a.coordinate.y)*q + 0.5*(a.coordinate.y - b.coordinate.y) + 0.5*(Rp[1] - a.coordinate.y))/q) * Boys[0]
                + (((c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + (c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(q*q) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(q*q) - 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*q - 0.5*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 0.5*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*q - 0.5*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
                + ((-(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p*q - (c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q - (c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + (c.coordinate.x - d.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(q*q) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*(p*p) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + ((Rq[0] - c.coordinate.x)*(Rq[0] - c.coordinate.x))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(q*q) + 0.5*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + 0.5*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p + 0.5*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + 0.5*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
                + (p*q*((c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 0.5*(Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+1, c.basis_index+0, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y) + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y) + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y))) * Boys[0]
                + (0.5*(2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + (Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z))/(p + q)) * Boys[1]
                + ((-2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + (Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + 2.0*(Rq[0] - c.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(-2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(Rp[2]-Rq[2]) + 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+1, c.basis_index+0, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z) + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y) - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y) - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
                + ((-2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*p - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(-2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1]) + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+1, c.basis_index+0, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[2] - a.coordinate.z)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (a.coordinate.y - b.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*q + 0.5*(a.coordinate.y - b.coordinate.y) + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (Rp[1] - a.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*q + 0.5*(Rp[1] - a.coordinate.y))/q) * Boys[0]
                + (0.25*(4.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q - 4.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) + 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - 4.0*(a.coordinate.y - b.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2]-Rq[2])*(q*q) - 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*q + 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q - 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(q*q) + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - 4.0*(Rp[1] - a.coordinate.y)*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2]-Rq[2])*(q*q) - 2.0*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*q - 4.0*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2] - a.coordinate.z)*(q*q) - 2.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*q + 4.0*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
                + ((-2.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.y - b.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(p*p) - 4.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + (a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.y - d.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p*q + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(p*p) - 4.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + (Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 4.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[1]-Rq[1])*((Rq[1] - c.coordinate.y)*(Rq[1] - c.coordinate.y))*(Rp[2]-Rq[2])*(q*q) + 3.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + (Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[1]-Rq[1])*p*q*(-2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p + 4.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 3.0*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+1, c.basis_index+1, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z) + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z) + (Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p - 2.0*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y) + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p - 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y) - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*q - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
                + ((-16.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 16.0*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 16.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*p*q - 16.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q + 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(q*q) - 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - 8.0*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q + 8.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 8.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
                + (p*q*(-2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - ((Rp[1]-Rq[1])*(Rp[1]-Rq[1])) + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - ((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+1, c.basis_index+1, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[2] - a.coordinate.z)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.y - b.coordinate.y)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(a.coordinate.y - b.coordinate.y) + (Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (Rp[1] - a.coordinate.y)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*q + 0.5*(Rp[1] - a.coordinate.y))/q) * Boys[0]
                + (0.0625*(16.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 16.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) + 8.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q + 32.0*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 16.0*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*q + 16.0*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*q + 16.0*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 16.0*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) + 8.0*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*q + 32.0*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q - 8.0*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*p - 16.0*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 8.0*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*q + 16.0*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*q - 16.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*(q*q) - 16.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) - 8.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*q)/(q*(p + q))) * Boys[1]
                + ((-2.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.z - d.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 4.0*(a.coordinate.y - b.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*p*q + 3.0*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1] - a.coordinate.y)*(c.coordinate.z - d.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p) - 4.0*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*p*q + 3.0*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*q - 4.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*((Rq[2] - c.coordinate.z)*(Rq[2] - c.coordinate.z))*(q*q) + (Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[2]-Rq[2])*p*q*(-2.0*(a.coordinate.y - b.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + 2.0*(Rp[1]-Rq[1])*(c.coordinate.z - d.coordinate.z)*(Rp[2]-Rq[2])*q - 2.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 4.0*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 3.0*(Rp[1]-Rq[1]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+1, c.basis_index+2, d.basis_index+2, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }

        if (c.basis_index != d.basis_index) {
            if (true) {
                add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x) + (a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x) + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x) + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x))) * Boys[0]
                    + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x) + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x) + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x) - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y))/(p + q)) * Boys[1]
                    + ((-16.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q + 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q - 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q - 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q + 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) - 8.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*q + 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p*q - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) - 8.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 8.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
                    + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q - ((Rp[1]-Rq[1])*(Rp[1]-Rq[1])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                    + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                    g_fock, a.basis_index+1, b.basis_index+0, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
                );
            }
            if (true) {
                add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x) + (a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x) + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x) + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x))) * Boys[0]
                    + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
                    + ((-2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(q*q) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(q*q) + (Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - (Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                    + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - (Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                    + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                    g_fock, a.basis_index+1, b.basis_index+0, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
                );
            }
            if (true) {
                add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y) + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y))) * Boys[0]
                    + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z) + 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z) - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
                    + ((-2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + (a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + (Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                    + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                    + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                    g_fock, a.basis_index+1, b.basis_index+0, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
                );
            }
            if (true) {
                add2fock_pppp(coefAndNorm * (((Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x) + (a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x) + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x) + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x))) * Boys[0]
                    + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + (Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z))/(p + q)) * Boys[1]
                    + ((-2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) + (Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - (Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                    + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - (Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                    + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                    g_fock, a.basis_index+2, b.basis_index+0, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
                );
            }
            if (true) {
                add2fock_pppp(coefAndNorm * (((Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x) + (a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x) + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x) + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x))) * Boys[0]
                    + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x) + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x) + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x) - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
                    + ((-16.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(a.coordinate.x - b.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*q + 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q + 8.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 8.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
                    + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - ((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                    + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                    g_fock, a.basis_index+2, b.basis_index+0, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
                );
            }
            if (true) {
                add2fock_pppp(coefAndNorm * (((Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y) + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y) + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y))) * Boys[0]
                    + (0.5*(2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y) + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y) + 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y) - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
                    + ((-2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.y - d.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                    + (p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1]) + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                    + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                    g_fock, a.basis_index+2, b.basis_index+0, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
                );
            }
            if (true) {
                add2fock_pppp(coefAndNorm * (((Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y) + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y))) * Boys[0]
                    + (0.5*(2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + (c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z) + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + (Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z))/(p + q)) * Boys[1]
                    + ((-2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + (Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                    + (p*q*(2.0*(c.coordinate.x - d.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(Rp[2]-Rq[2]) + 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                    + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                    g_fock, a.basis_index+2, b.basis_index+1, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
                );
            }

            if (true) {
                add2fock_pppp(coefAndNorm * (((Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y) + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y))) * Boys[0]
                    + (0.5*(2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y) + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y) - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y) + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y) - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
                    + ((-2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*q + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                    + (p*q*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1]) + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                    + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                    g_fock, a.basis_index+2, b.basis_index+1, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
                );
            }
            if (true) {
                add2fock_pppp(coefAndNorm * (((Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y) + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y) + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y))) * Boys[0]
                    + (0.5*(2.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y) + 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y) + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y) - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y) - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
                    + ((-16.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 16.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 16.0*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 16.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 8.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 8.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
                    + (p*q*(-2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - ((Rp[1]-Rq[1])*(Rp[1]-Rq[1])) + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - ((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                    + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                    g_fock, a.basis_index+2, b.basis_index+1, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
                );
            }
        }
    }


    if (c.basis_index != d.basis_index) {
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[1] - c.coordinate.y)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*p + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*p + (c.coordinate.x - d.coordinate.x)*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*p + 0.5*(c.coordinate.x - d.coordinate.x) + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[0] - c.coordinate.x)*p + 0.5*(Rq[0] - c.coordinate.x))/p) * Boys[0]
                + (0.125*(8.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(p*p) - 8.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p*q + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(p*p) + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(p*p) - 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*p*q + 4.0*(a.coordinate.x - b.coordinate.x)*(Rq[1] - c.coordinate.y)*p + 8.0*(c.coordinate.x - d.coordinate.x)*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[1]-Rq[1])*(p*p) - 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p*q + 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*p - 4.0*(c.coordinate.x - d.coordinate.x)*(Rq[1] - c.coordinate.y)*q + 8.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(p*p) + 8.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*p + 4.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p + 4.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p - 4.0*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*q)/(p*(p + q))) * Boys[1]
                + ((-2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p*q + (a.coordinate.x - b.coordinate.x)*(Rp[1]-Rq[1])*p - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*q + 2.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*p*q - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(q*q) + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - 3.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[0]-Rq[0])*p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*q - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q - 3.0*(Rp[1]-Rq[1]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+0, b.basis_index+0, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[2] - c.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*p + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*p + (c.coordinate.x - d.coordinate.x)*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*p + 0.5*(c.coordinate.x - d.coordinate.x) + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[0] - c.coordinate.x)*p + 0.5*(Rq[0] - c.coordinate.x))/p) * Boys[0]
                + (0.125*(8.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*(p*p) - 8.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*(p*p) + 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(p*p) - 8.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*p*q + 4.0*(a.coordinate.x - b.coordinate.x)*(Rq[2] - c.coordinate.z)*p + 8.0*(c.coordinate.x - d.coordinate.x)*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[2]-Rq[2])*(p*p) - 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p*q + 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*p - 4.0*(c.coordinate.x - d.coordinate.x)*(Rq[2] - c.coordinate.z)*q + 8.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*(p*p) + 8.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z)*p + 4.0*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p + 4.0*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p - 4.0*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
                + ((-2.0*(a.coordinate.x - b.coordinate.x)*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(p*p) - 2.0*(a.coordinate.x - b.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[2] - c.coordinate.z)*p*q - 2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p*q + (a.coordinate.x - b.coordinate.x)*(Rp[2]-Rq[2])*p - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[2] - c.coordinate.z)*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*q + 2.0*((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rp[0] - a.coordinate.x)*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[2] - c.coordinate.z)*p*q - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*(q*q) + (Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - 3.0*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q - (Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[0]-Rq[0])*p*q*(-2.0*(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*q - 4.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q - 3.0*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+0, b.basis_index+0, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[2] - c.coordinate.z)*((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*p + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*p + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(c.coordinate.y - d.coordinate.y)*p + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[1] - c.coordinate.y)*p + 0.5*(c.coordinate.y - d.coordinate.y) + 0.5*(Rq[1] - c.coordinate.y))/p) * Boys[0]
                + (((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*(p*p) + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(p*p) + (a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*(p*p) + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(p*p) + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q + 0.5*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p - 0.5*(c.coordinate.y - d.coordinate.y)*(Rq[2] - c.coordinate.z)*q + 0.5*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 0.5*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 0.5*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
                + (((a.coordinate.x - b.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p*q - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - (a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + ((Rp[0] - a.coordinate.x)*(Rp[0] - a.coordinate.x))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rq[2] - c.coordinate.z)*(q*q) + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*(q*q) - 0.5*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + 0.5*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 0.5*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - 0.5*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
                + (p*q*(-(a.coordinate.x - b.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + ((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 0.5*(Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+0, b.basis_index+0, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y) + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y))) * Boys[0]
                + (0.5*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x) - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*q + (a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y) + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y))/(p + q)) * Boys[1]
                + ((-16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q - 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p*q - 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q + 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) - 8.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*q + 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(p*p) + 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p*q - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p*q - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(q*q) - 8.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q + 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 8.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
                + (p*q*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q - ((Rp[1]-Rq[1])*(Rp[1]-Rq[1])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+0, b.basis_index+1, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y) + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y) + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y))) * Boys[0]
                + (0.5*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z) + (Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
                + ((-2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(q*q) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*(p*p) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(q*q) + (a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p + (Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - (Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - (Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+0, b.basis_index+1, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y) + (a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y) + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y) + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y))) * Boys[0]
                + (0.5*(2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
                + ((2.0*(Rp[0] - a.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + (Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(q*q) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(-2.0*(Rp[0] - a.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+0, b.basis_index+1, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z) + (Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + (Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z))/(p + q)) * Boys[1]
                + ((-2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(p*p) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) + (Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + (Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - (Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - (Rp[1]-Rq[1])*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+0, b.basis_index+2, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z) + (Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x) - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x) - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
                + ((-16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0] - a.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*q + 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(p*p) + 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*p - 16.0*(Rp[0] - a.coordinate.x)*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 16.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*q + 8.0*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 8.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 8.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
                + (p*q*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 2.0*(Rp[0] - a.coordinate.x)*(Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - ((Rp[0]-Rq[0])*(Rp[0]-Rq[0])) + 2.0*(Rp[0]-Rq[0])*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - ((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[0]-Rq[0])*(Rp[0]-Rq[0]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+0, b.basis_index+2, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[0] - a.coordinate.x)*(Rq[2] - c.coordinate.z)*((c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z) + (Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y) - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
                + ((-2.0*(Rp[0] - a.coordinate.x)*(c.coordinate.y - d.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(p*p) + 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(Rp[0] - a.coordinate.x)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(-2.0*(Rp[0] - a.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p + 2.0*(Rp[0]-Rq[0])*(c.coordinate.y - d.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1]) + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+0, b.basis_index+2, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[1] - c.coordinate.y)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*p + (c.coordinate.x - d.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*p + 0.5*(c.coordinate.x - d.coordinate.x) + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*p + (Rq[0] - c.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*p + 0.5*(Rq[0] - c.coordinate.x))/p) * Boys[0]
                + (0.25*(4.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 4.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*p + 4.0*(c.coordinate.x - d.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(p*p) - 8.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rq[1] - c.coordinate.y)*q + 4.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(p*p) + 4.0*(Rp[0]-Rq[0])*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rq[1] - c.coordinate.y)*(p*p) + 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p + 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*p + 4.0*(Rq[0] - c.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(p*p) - 8.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 4.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*q)/(p*(p + q))) * Boys[1]
                + ((-2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*(q*q) - 3.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*q + 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(p*p) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*p + 2.0*(Rp[0]-Rq[0])*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(p*p) - 4.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q - 4.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*p*q + 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*(q*q) - 3.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[1]-Rq[1])*p*q*(2.0*(c.coordinate.x - d.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q - 2.0*(Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*p - 4.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q - 3.0*(Rp[0]-Rq[0]) + 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+1, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[2] - c.coordinate.z)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*p + (c.coordinate.x - d.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*p + 0.5*(c.coordinate.x - d.coordinate.x) + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*p + (Rq[0] - c.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*p + 0.5*(Rq[0] - c.coordinate.x))/p) * Boys[0]
                + (((c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - (c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q + (c.coordinate.x - d.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[2]-Rq[2])*(p*p) - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q + 0.5*(c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*p - 0.5*(c.coordinate.x - d.coordinate.x)*(Rq[2] - c.coordinate.z)*q + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*(p*p) + (Rp[0]-Rq[0])*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rq[2] - c.coordinate.z)*(p*p) + 0.5*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p + (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q + (Rq[0] - c.coordinate.x)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q + 0.5*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p - 0.5*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
                + ((-(c.coordinate.x - d.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + (c.coordinate.x - d.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*(q*q) - 0.5*(c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*q + (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q + 0.5*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - 0.5*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q - (Rq[0] - c.coordinate.x)*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + (Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*(q*q) - 0.5*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
                + (p*q*((c.coordinate.x - d.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + (Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*q - 0.5*(Rp[0]-Rq[0])*(Rp[2]-Rq[2]) + (Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*q)/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+1, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[2] - c.coordinate.z)*((a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*p + (a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*p + (c.coordinate.y - d.coordinate.y)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*p + 0.5*(c.coordinate.y - d.coordinate.y) + ((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rq[1] - c.coordinate.y)*p + 0.5*(Rq[1] - c.coordinate.y))/p) * Boys[0]
                + (0.125*(8.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 8.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(p*p) + 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 8.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q + 4.0*(a.coordinate.y - b.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 8.0*(c.coordinate.y - d.coordinate.y)*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[2]-Rq[2])*(p*p) - 16.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p*q + 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p - 4.0*(c.coordinate.y - d.coordinate.y)*(Rq[2] - c.coordinate.z)*q + 8.0*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*(p*p) + 8.0*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*p + 4.0*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 4.0*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 4.0*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
                + ((-2.0*(a.coordinate.y - b.coordinate.y)*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 2.0*(a.coordinate.y - b.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*p*q - 2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + (a.coordinate.y - b.coordinate.y)*(Rp[2]-Rq[2])*p - 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q + 2.0*(c.coordinate.y - d.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*(q*q) - (c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*((Rp[1] - a.coordinate.y)*(Rp[1] - a.coordinate.y))*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rp[1] - a.coordinate.y)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*p*q - 4.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q + 2.0*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*p + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*(q*q) + (Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 3.0*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - (Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[1]-Rq[1])*p*q*(-2.0*(a.coordinate.y - b.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*q - 4.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 3.0*(Rp[2]-Rq[2]))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+1, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z) + (Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + (c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z) + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*q + (Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z))/(p + q)) * Boys[1]
                + ((-2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(p*p) + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p*q + (Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*p*q - 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(q*q) - (Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(2.0*(c.coordinate.x - d.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*p - 2.0*(Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q - (Rp[0]-Rq[0])*(Rp[2]-Rq[2]) + 2.0*(Rq[0] - c.coordinate.x)*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+2, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z) + (Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z) + (Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y) - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y) - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q)/(p + q)) * Boys[1]
                + ((-2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*q + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(p*p) + 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + (p*q*(2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 2.0*(Rp[0]-Rq[0])*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1]) + 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+2, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rp[1] - a.coordinate.y)*(Rq[2] - c.coordinate.z)*((c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z) + (Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z) + (Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z))) * Boys[0]
                + (0.5*(2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y) - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p + 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + (Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y) - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*q - 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*q + (a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z) + (Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z))/(p + q)) * Boys[1]
                + ((-16.0*(c.coordinate.y - d.coordinate.y)*(Rp[1] - a.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 16.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*q + 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(p*p) + 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 16.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 8.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*p - 16.0*(Rp[1] - a.coordinate.y)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 16.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 16.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*p*q - 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q + 16.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*(q*q) - 8.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*q + 8.0*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p + 8.0*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 8.0*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q + 4.0)/(16.0*(p*p) + 32.0*p*q + 16.0*(q*q))) * Boys[2]
                + (p*q*(2.0*(c.coordinate.y - d.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 2.0*(Rp[1] - a.coordinate.y)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - ((Rp[1]-Rq[1])*(Rp[1]-Rq[1])) + 2.0*(Rp[1]-Rq[1])*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - ((Rp[2]-Rq[2])*(Rp[2]-Rq[2])))/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + (((Rp[1]-Rq[1])*(Rp[1]-Rq[1]))*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+1, b.basis_index+2, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[1] - c.coordinate.y)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*p + (c.coordinate.x - d.coordinate.x)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*p + 0.5*(c.coordinate.x - d.coordinate.x) + (Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*p + (Rq[0] - c.coordinate.x)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*p + 0.5*(Rq[0] - c.coordinate.x))/p) * Boys[0]
                + (((c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + (c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 0.5*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*p - (c.coordinate.x - d.coordinate.x)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(c.coordinate.x - d.coordinate.x)*(Rq[1] - c.coordinate.y)*q + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 0.5*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*p + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 0.5*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*p - (Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*q)/(p*(p + q))) * Boys[1]
                + ((-(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*q + (c.coordinate.x - d.coordinate.x)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(q*q) + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(p*p) + (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(p*p) + 0.5*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*p - (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*q - (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p*q - 2.0*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p*q - 0.5*(Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*q + (Rq[0] - c.coordinate.x)*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(q*q))/((p*p) + 2.0*p*q + (q*q))) * Boys[2]
                + (p*q*((c.coordinate.x - d.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - (Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 2.0*(Rp[0]-Rq[0])*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p - 0.5*(Rp[0]-Rq[0])*(Rp[1]-Rq[1]) + (Rp[0]-Rq[0])*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q + (Rq[0] - c.coordinate.x)*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/((p*p*p) + 3.0*(p*p)*q + 3.0*p*(q*q) + (q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*(Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+2, c.basis_index+1, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[2] - c.coordinate.z)*((c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*p + (c.coordinate.x - d.coordinate.x)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*p + 0.5*(c.coordinate.x - d.coordinate.x) + (Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*p + (Rq[0] - c.coordinate.x)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*p + 0.5*(Rq[0] - c.coordinate.x))/p) * Boys[0]
                + (0.25*(4.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 4.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z)*p + 4.0*(c.coordinate.x - d.coordinate.x)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(p*p) - 8.0*(c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z)*p + 2.0*(c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.x - d.coordinate.x)*(Rq[2] - c.coordinate.z)*q + 4.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*(p*p) + 4.0*(Rp[0]-Rq[0])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rq[2] - c.coordinate.z)*(p*p) + 2.0*(Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*p + 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*p + 4.0*(Rq[0] - c.coordinate.x)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(p*p) - 8.0*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 4.0*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*p - 2.0*(Rq[0] - c.coordinate.x)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
                + ((-2.0*(c.coordinate.x - d.coordinate.x)*(a.coordinate.z - b.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 4.0*(c.coordinate.x - d.coordinate.x)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(c.coordinate.x - d.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*(q*q) - 3.0*(c.coordinate.x - d.coordinate.x)*(Rp[2]-Rq[2])*q + 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rp[0]-Rq[0])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 2.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*p + (Rp[0]-Rq[0])*(Rp[2]-Rq[2])*p - (Rp[0]-Rq[0])*(Rq[2] - c.coordinate.z)*q - 2.0*(Rq[0] - c.coordinate.x)*(a.coordinate.z - b.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 4.0*(Rq[0] - c.coordinate.x)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*(q*q) - 3.0*(Rq[0] - c.coordinate.x)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[2]-Rq[2])*p*q*(2.0*(c.coordinate.x - d.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 2.0*(Rp[0]-Rq[0])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 4.0*(Rp[0]-Rq[0])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[0]-Rq[0])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 3.0*(Rp[0]-Rq[0]) + 2.0*(Rq[0] - c.coordinate.x)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[0]-Rq[0])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+2, c.basis_index+2, d.basis_index+0, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
        if (true) {
            add2fock_pppp(coefAndNorm * (((Rq[2] - c.coordinate.z)*((c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*p + (c.coordinate.y - d.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*p + 0.5*(c.coordinate.y - d.coordinate.y) + (Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*p + (Rq[1] - c.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*p + 0.5*(Rq[1] - c.coordinate.y))/p) * Boys[0]
                + (0.25*(4.0*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 4.0*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 2.0*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + 4.0*(c.coordinate.y - d.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(p*p) - 8.0*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(c.coordinate.y - d.coordinate.y)*(Rq[2] - c.coordinate.z)*q + 4.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rq[2] - c.coordinate.z)*(p*p) + 4.0*(Rp[1]-Rq[1])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rq[2] - c.coordinate.z)*(p*p) + 2.0*(Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*p + 4.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 2.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*p + 4.0*(Rq[1] - c.coordinate.y)*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(p*p) - 8.0*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 4.0*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*p + 2.0*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*p - 2.0*(Rq[1] - c.coordinate.y)*(Rq[2] - c.coordinate.z)*q)/(p*(p + q))) * Boys[1]
                + ((-2.0*(c.coordinate.y - d.coordinate.y)*(a.coordinate.z - b.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 4.0*(c.coordinate.y - d.coordinate.y)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(c.coordinate.y - d.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*(q*q) - 3.0*(c.coordinate.y - d.coordinate.y)*(Rp[2]-Rq[2])*q + 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(p*p) - 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + (Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*p + 2.0*(Rp[1]-Rq[1])*((Rp[2] - a.coordinate.z)*(Rp[2] - a.coordinate.z))*(Rp[2]-Rq[2])*(p*p) - 4.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*p*q + 2.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*p + (Rp[1]-Rq[1])*(Rp[2]-Rq[2])*p - (Rp[1]-Rq[1])*(Rq[2] - c.coordinate.z)*q - 2.0*(Rq[1] - c.coordinate.y)*(a.coordinate.z - b.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q - 4.0*(Rq[1] - c.coordinate.y)*(Rp[2] - a.coordinate.z)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*p*q + 2.0*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(Rq[2] - c.coordinate.z)*(q*q) - 3.0*(Rq[1] - c.coordinate.y)*(Rp[2]-Rq[2])*q)/(2.0*(p*p) + 4.0*p*q + 2.0*(q*q))) * Boys[2]
                + ((Rp[2]-Rq[2])*p*q*(2.0*(c.coordinate.y - d.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q - 2.0*(Rp[1]-Rq[1])*(a.coordinate.z - b.coordinate.z)*(Rp[2]-Rq[2])*p - 4.0*(Rp[1]-Rq[1])*(Rp[2] - a.coordinate.z)*(Rp[2]-Rq[2])*p + 2.0*(Rp[1]-Rq[1])*(Rp[2]-Rq[2])*(Rq[2] - c.coordinate.z)*q - 3.0*(Rp[1]-Rq[1]) + 2.0*(Rq[1] - c.coordinate.y)*((Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*q)/(2.0*(p*p*p) + 6.0*(p*p)*q + 6.0*p*(q*q) + 2.0*(q*q*q))) * Boys[3]
                + ((Rp[1]-Rq[1])*((Rp[2]-Rq[2])*(Rp[2]-Rq[2])*(Rp[2]-Rq[2]))*(p*p)*(q*q)/((p*p*p*p) + 4.0*(p*p*p)*q + 6.0*(p*p)*(q*q) + 4.0*p*(q*q*q) + (q*q*q*q))) * Boys[4]),
                g_fock, a.basis_index+2, b.basis_index+2, c.basis_index+2, d.basis_index+1, num_basis, g_dens, g_cgto_normalization_factors, nosym_braket
            );
        }
    }


}











} // namespace gansu::gpu


#endif